
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9.1. Two-Sample Hypothesis Testing &#8212; Hands-on Network Machine Learning with Scikit-Learn and Graspologic</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.2. Graph Matching" href="graph-matching-vertex.html" />
    <link rel="prev" title="9. Applications for Two Networks" href="ch9.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Hands-on Network Machine Learning with Scikit-Learn and Graspologic</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../coverpage.html">
   Hands-on Network Machine Learning with Scikit-Learn and Graspologic
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../introduction/preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../introduction/terminology.html">
   Terminology and Math Refresher
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/ch1/ch1.html">
   1. The Network Machine Learning Landscape
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/what-is-a-network.html">
     1.1. What Is A Network?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/why-study-networks.html">
     1.2. Why Study Networks?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/examples-of-applications.html">
     1.3. Examples of applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/types-of-networks.html">
     1.4. Types of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/types-of-learning-probs.html">
     1.5. Types of Network Learning Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/main-challenges.html">
     1.6. Main Challenges of Network Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/exercises.html">
     1.7. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/ch2/ch2.html">
   2. End-to-end Biology Network Machine Learning Project
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/big-picture.html">
     2.1. Look at the big picture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/get-the-data.html">
     2.2. Get the Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/prepare-the-data.html">
     2.3. Prepare the Data for Network Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/transformation-techniques.html">
     2.4. Transformation Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/select-and-train.html">
     2.5. Select and Train a Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/fine-tune.html">
     2.6. Fine-Tune your Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/ch3/ch3.html">
   3. End-to-end Business Network Machine Learning Project
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/big-picture.html">
     3.1. Look at the Big Picture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/get-the-data.html">
     3.2. Get the Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/discover-and-visualize.html">
     3.3. Discover and Visualize the Data to Gain Insights
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/prepare-the-data.html">
     3.4. Prepare the Data for Network Algorithms
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Representations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../representations/ch4/ch4.html">
   4. Properties of Networks as a Statistical Object
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch4/matrix-representations.html">
     4.1. Matrix Representations Of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch4/network-representations.html">
     4.2. Representations of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch4/properties-of-networks.html">
     4.3. Properties of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch4/regularization.html">
     4.4. Regularization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../representations/ch5/ch5.html">
   5. Why Use Statistical Models?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/why-use-models.html">
     5.1. Why Use Statistical Models?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/single-network-models_ER.html">
     5.2. Erdös-Rényi (ER) Random Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/single-network-models_SBM.html">
     5.3. Stochastic Block Models (SBM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/single-network-models_RDPG.html">
     5.4. Random Dot Product Graphs (RDPG)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/multi-network-models.html">
     5.5. Multiple Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch5/single-network-models_theory.html">
     5.6. Single network model theory
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../representations/ch6/ch6.html">
   6. Learning Network Representations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/estimating-parameters_mle.html">
     6.1. Estimating Parameters in Network Models via MLE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/why-embed-networks.html">
     6.2. Why embed networks?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/estimating-parameters_spectral.html">
     6.3. Estimating Parameters with Spectaal Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/random-walk-diffusion-methods.html">
     6.4. Random-Walk and Diffusion-based Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/graph-neural-networks.html">
     6.5. Graph Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/multigraph-representation-learning.html">
     6.6. Multiple-Network Representation Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/joint-representation-learning.html">
     6.7. Joint Representation Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch6/estimating-parameters_theory.html">
     6.8. Model Estimation Theory
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../representations/ch7/ch7.html">
   7. Theoretical Results
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch7/theory-single-network.html">
     7.1. Theory for Single Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch7/theory-multigraph.html">
     7.2. Theory for Multiple-Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../representations/ch7/theory-matching.html">
     7.3. Theory for Graph Matching
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ch8/ch8.html">
   8. Applications When You Have One Network
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch8/community-detection.html">
     8.1. Community Detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch8/testing-differences.html">
     8.2. Testing for Differences between Groups of Edges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch8/model-selection.html">
     8.3. Model Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch8/single-vertex-nomination.html">
     8.4. Single-Network Vertex Nomination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch8/out-of-sample.html">
     8.5. Out-of-sample Embedding
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ch9.html">
   9. Applications for Two Networks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     9.1. Two-Sample Hypothesis Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="graph-matching-vertex.html">
     9.2. Graph Matching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multiple-vertex-nomination.html">
     9.3. Vertex Nomination For Multiple Networks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ch10/ch10.html">
   10. Applications for Many Networks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10/anomaly-detection.html">
     10.1. Anomaly Detection For Timeseries of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10/significant-edges.html">
     10.2. Testing for Significant Edges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10/significant-vertices.html">
     10.3. Testing for Significant Vertices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10/significant-communities.html">
     10.4. Testing for Significant Communities
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://graspologic.readthedocs.io/en/latest/">
   Graspologic Documentation
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/applications/ch9/two-sample-hypothesis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/neurodata/graph-stats-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/neurodata/graph-stats-book/issues/new?title=Issue%20on%20page%20%2Fapplications/ch9/two-sample-hypothesis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/neurodata/graph-stats-book/edit/master/network_machine_learning_in_python/applications/ch9/two-sample-hypothesis.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/neurodata/graph-stats-book/master?urlpath=tree/network_machine_learning_in_python/applications/ch9/two-sample-hypothesis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hypothesis-testing">
   9.1.1. Hypothesis Testing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#latent-position-graph-testing">
   9.1.2. Latent Position Graph Testing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#latent-distribution-two-graph-testing">
   9.1.3. Latent Distribution Two-Graph Testing
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="two-sample-hypothesis-testing">
<h1><span class="section-number">9.1. </span>Two-Sample Hypothesis Testing<a class="headerlink" href="#two-sample-hypothesis-testing" title="Permalink to this headline">¶</a></h1>
<p>We have learned a lot thus far about graph statistics, and now we want to apply some of that knowledge to doing two-sample graph testing. Imagine you are part of an alien race called the Moops. You live in harmony with another race, called the Moors, that look very similar to you, on the planet Zinthar. The evil overlord Zelu takes a random number of Moops and Moors and puts them on an island. You want to find your fellow Moops, but the Moops and Moors look very similar to each other. The one difference between the groups is that if you had an MRI machine, there is a difference between the scans of Moops and Moors. Lucky for you, you have an MRI machine on the island. What do you do?</p>
<p>This problem requires you to use two-sample testing on graphs. There are two types of tests that you can perform The first is given two graphs, and their corresponding latent positions, are their positions the same? Or, we can ask, are the distributions of the latent positions the same? Before we learn how to perform these tests, we should go through what hypothesis testing is and how algorithms in <code class="docutils literal notranslate"><span class="pre">graspologic</span></code> answer these questions.</p>
<div class="section" id="hypothesis-testing">
<h2><span class="section-number">9.1.1. </span>Hypothesis Testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this headline">¶</a></h2>
<p>Hypothesis testing is quite the daunting subject to explain, but it essentially boils down to it’s name, testing hypotheses. We first need to fomulate a statistical model of what the data looks like. In general, that means making a few assumptions about how the data we observed came to be; in our case, we each sample is observed independently from the other, and that the probability of observing such data is identical for each data. This is what is known as independently and identically distributed (i.i.d.). We consider the distribution where our observations are sampled from as really anything. Our model could say that this distribution of a Gaussian, for example, in which case we would have to estimate the parameters of this Gaussian. This would be a <strong>parametric model</strong>. When we consider the distribution to be something else, called <span class="math notranslate nohighlight">\(F\)</span>, then we have a <strong>nonparametric model</strong>. Mathematically, we can write the above as follows: we are given data <span class="math notranslate nohighlight">\(X_1, \ldots, X_n\)</span> (so, <span class="math notranslate nohighlight">\(n\)</span> observations) sampled i.i.d. from <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>Now, we need to set up the actual test. When testing, we have two types of hypotheses, a null hypothesis and an alternative hypothesis. We generally test against the null hypothesis, so, in practice, the null hypothesis is one of “no effect” or “no difference”. It is denoted by <span class="math notranslate nohighlight">\(H_0\)</span>. The alternative hypothesis, denoted by <span class="math notranslate nohighlight">\(H_A\)</span> is generally what we believe. So, when performing hypothesis tests, we generally want to reject our null hypothesis, meaning that the general “accepted” belief of the model is not true, and our hypothesis is true. We can not always do that, in which case we do not necessarily accept the alternative hypothesis, but failr to reject the null hypothesis. This is because the lack of evidence from our data doesn’t mean that the null hypothesis effect does not exist.</p>
<p>We won’t given an exhaustive list of the types of hypothesis tests, since, quite frankly, there are a lot. So, here, we will focus on two common used ones: independence testing and two-sample testing. When performing indepdence testing, we are testing whether two random variables, <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are sampled independently from some joint distribution of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> (called <span class="math notranslate nohighlight">\(F_{XY}\)</span>) or not. In this case, <span class="math notranslate nohighlight">\(F_X\)</span> is the distribution of <span class="math notranslate nohighlight">\(X\)</span>, and <span class="math notranslate nohighlight">\(F_Y\)</span> is the distribution of <span class="math notranslate nohighlight">\(Y\)</span>. Specifially, this means</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    H_0 &amp;: F_{XY} = F_X F_Y \\
    H_A &amp;: F_{XY} \neq F_X F_Y
\end{align*}\]</div>
<p>This is what is known as a general independence test. Here, the null hypothesis is the <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are independent (which means the joint distribution is equal to the product of the marginal distributions <span class="math notranslate nohighlight">\(F_X\)</span> and <span class="math notranslate nohighlight">\(F_Y\)</span>). The alternative hypothesis is that <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are not independent (and so the joint distribution is not equal to the product of the marginal distributions).</p>
<p>Another type of testing is two-sample testing. Here, we are testing whether the distribution of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are the same or different. So, is <span class="math notranslate nohighlight">\(X\)</span> has distribution <span class="math notranslate nohighlight">\(F_X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> has distribution <span class="math notranslate nohighlight">\(F_Y\)</span>, we are testing</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    H_0 &amp;: F_X = F_Y \\
    H_A &amp;: F_X \neq F_Y
\end{align*}\]</div>
<p>This is known as a general two-sample testing. Here, the null hypothesis is that the distributions of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are the same, and the alternative is that <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> do not have the same distribution.</p>
<p>Now that we know what testing essentially is, how do we perform it? Well, we have independence tests and two-sample tests that actually perform the tests. When running any test, the minmum information we get is a test statistic and p-value. The test statistic tells you, given your data, whether or not you should reject the null hypothesis. Of course, the ranges of test statics are large and varied, some are between -1 and 1, some are between 0 and 1, etc. So, we need a crtical value for the test, and that tells us that if our test statistic is above this critical value, we should reject, and if our test statistic is below that value, we should reject.The value of the critical value depends on the test, can depend on the sample size, etc.</p>
<p>The p-value can be thought of as a way to gauge our confidence, like what is the probability that the result that we got occurs due to chance? Specifically, what is the probability that we observe statstics in our the distribution of our null hypothesis more extreme than our observed statistic? In general, we consider whether our p-value is greater than or less than 0.05; we reject the null hypothesis when the p-value is less than 0.05 and fail to reject the null hypothesis when our p-value is greater than 0.05. This basically allows us to say that we are 95% conifident that our test results are not due to chance. It’s worth noting that the threshold of 0.05 is fairly arbitray. Lower values like 0.01 and even 0.001 are also valid to use. This allows us to be even more confident in the results of our test. Changing the threshold involves rerunning the test, since it changes the p-value you get.</p>
<p>Sometimes, for certain tests, the p-value can be found finding the null distribution by estimating parameters of a distribution and computing the p-value that way. For the nonparametric model, which we end up using in our tests, we need another solution instead. So, we can estimate the null distribution using a permutation test. Here, we compute an observed test statistic. Then, we permute our data and recompute our test statistics a number of times. This permutation our data essentially estimates our null distribution. Then, we can compute our crtical value and p-value from this estimated null distribution. Of course, this process isn’t perfect since it is an estimate of the null distribution and not the actual distribution, but it is the best that can be done.</p>
</div>
<div class="section" id="latent-position-graph-testing">
<h2><span class="section-number">9.1.2. </span>Latent Position Graph Testing<a class="headerlink" href="#latent-position-graph-testing" title="Permalink to this headline">¶</a></h2>
<p>Now that we have introduded what hypothesis testing is specifically, we can go back to our example. Let’s answer the first question: given two graphs, and their corresponding latent positions, are their latent positions the same?</p>
<p>First, let’s input some relevant packages:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">graspologic.inference</span> <span class="kn">import</span> <span class="n">latent_position_test</span><span class="p">,</span> <span class="n">latent_distribution_test</span>
<span class="kn">from</span> <span class="nn">graspologic.embed</span> <span class="kn">import</span> <span class="n">AdjacencySpectralEmbed</span>
<span class="kn">from</span> <span class="nn">graspologic.simulations</span> <span class="kn">import</span> <span class="n">sbm</span><span class="p">,</span> <span class="n">rdpg</span>
<span class="kn">from</span> <span class="nn">graspologic.utils</span> <span class="kn">import</span> <span class="n">symmetrize</span>
<span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">heatmap</span><span class="p">,</span> <span class="n">pairplot</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>We previously discussed what a stochastic block model (SBM) was. Remember that an adjancy matrix is a matrix where each entry denotes a node’s connection to another node. When the matrix is composed of “communities” or “blocks”, where a node’s block membership in a graph determines its probability of connection to the other nodes in the graph. We embedded the graph using adjancy spectral embedding (ASE), visualized it using a pairplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># the number of embedding dimensions for ASE</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]])</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">symmetrize</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">csize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">csize</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;4-block SBM adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;4-block adjacency spectral embedding&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_6_0.png" src="../../_images/two-sample-hypothesis_6_0.png" />
<img alt="../../_images/two-sample-hypothesis_6_1.png" src="../../_images/two-sample-hypothesis_6_1.png" />
</div>
</div>
<p>In the adjacency matrix above, we can see a clearly defined block structure in the 4 communities in the graph. Below it, we see the adjancy spectral embedding (ASE). ASE is one such embedding procedures, and it allows us to estimate latent positions of the graph. Latent positions refer to the the ideas in random dot product graphs (RDPG).</p>
<p>For a graph with adjancy matrix <span class="math notranslate nohighlight">\(A\)</span>, the proability of an edge existing between two nodes is determined by a matrix <span class="math notranslate nohighlight">\(P\)</span>. We can represent P as <span class="math notranslate nohighlight">\(P = XX^T\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is the latent positions of the graph. ASE allows us to obtain an estimate of these positions. Since, in the pairplot, we see 4 clusters of nodes corresponding to the 4 blocks, ASE is ablove to recover the positions and so RDPGs can model an SBM.</p>
<p>Now, we can estimate <span class="math notranslate nohighlight">\(X\)</span> and sample two new RDPGs from the same latent positions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">rdpg</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>
          <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">rdpg</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>
          <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">Xhat1</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
<span class="n">Xhat2</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 1 adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 2 adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">pairplot</span><span class="p">(</span><span class="n">Xhat1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 1 adjacency spectral embedding&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">Xhat2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 2 adjacency spectral embedding&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_8_0.png" src="../../_images/two-sample-hypothesis_8_0.png" />
<img alt="../../_images/two-sample-hypothesis_8_1.png" src="../../_images/two-sample-hypothesis_8_1.png" />
<img alt="../../_images/two-sample-hypothesis_8_2.png" src="../../_images/two-sample-hypothesis_8_2.png" />
<img alt="../../_images/two-sample-hypothesis_8_3.png" src="../../_images/two-sample-hypothesis_8_3.png" />
</div>
</div>
<p>Both the simulated RDPGs have 4 clear blocks and 4 clusters. Now, we must test whether or not they cam from the same latent positions.</p>
<p>Based on the way we simulated the graph, we know that our two inputs are sampled from the same latent positions. So, we can test whether or not the RDPGs are the same up to a rotation using <code class="docutils literal notranslate"><span class="pre">latent_position_test</span></code> in <code class="docutils literal notranslate"><span class="pre">graspologic</span></code>. So, we are testing,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    H_0 &amp;: X_1 = X_2 R \\
    H_A &amp;: X_1 \neq X_2 R
\end{align*}\]</div>
<p>So, are latent positions for graph 1 (<span class="math notranslate nohighlight">\(X_1\)</span>) and latent positions for graph 2 (<span class="math notranslate nohighlight">\(X_2\)</span>) the same (null) or different (alternative) up to a rotation. In this case, we know they are the same, so we expect the p-value to be high. Here, <span class="math notranslate nohighlight">\(R\)</span> is an orthogonal rotaion matrix found from solving the orthogonal procrustes problem (we won’t go over it in detail here). So, we run the test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lpt</span> <span class="o">=</span> <span class="n">latent_position_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lpt</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p = 1.8227332606890925
</pre></div>
</div>
</div>
</div>
<p>We see that the p-value is high, much greater than 0.05, and so this means that any observed differences between the latent positions of sampled RDPG 1 and 2 are likely due to chance.</p>
<p>Next, we can do the same test, except we add noise to one of the RDPGs. The matched test should have a low p-value and so we should reject the null hypothesis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A3</span> <span class="o">=</span> <span class="n">rdpg</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>
          <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">A4</span> <span class="o">=</span> <span class="n">rdpg</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
          <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">Xhat3</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
<span class="n">Xhat4</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A4</span><span class="p">)</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 3 adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 4 (distorted) adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">pairplot</span><span class="p">(</span><span class="n">Xhat3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 3 adjacency spectral embedding&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">Xhat4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sampled RDPG 4 (distorted) adjacency spectral embedding&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_12_0.png" src="../../_images/two-sample-hypothesis_12_0.png" />
<img alt="../../_images/two-sample-hypothesis_12_1.png" src="../../_images/two-sample-hypothesis_12_1.png" />
<img alt="../../_images/two-sample-hypothesis_12_2.png" src="../../_images/two-sample-hypothesis_12_2.png" />
<img alt="../../_images/two-sample-hypothesis_12_3.png" src="../../_images/two-sample-hypothesis_12_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lpt</span> <span class="o">=</span> <span class="n">latent_position_test</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lpt</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p = 2.4144462545646994
</pre></div>
</div>
</div>
</div>
<p>We see that the p-value is high, less than 0.05, and so this means that any observed differences between the latent positions of sampled RDPG 1 and 2 are likely due to chance.</p>
</div>
<div class="section" id="latent-distribution-two-graph-testing">
<h2><span class="section-number">9.1.3. </span>Latent Distribution Two-Graph Testing<a class="headerlink" href="#latent-distribution-two-graph-testing" title="Permalink to this headline">¶</a></h2>
<p>Now that we have introduded what hypothesis testing is specifically, we can go back to our example. Let’s answer the first question: given two graphs, and their corresponding latent positions, are the distributions of their latent positions the same?</p>
<p>Let’s generate a 2-block SBM and embed it with ASE like we did above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># the number of embedding dimensions for ASE</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>
<span class="n">csize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">A1</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">csize</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block SBM adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block adjacency spectral embedding&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_16_0.png" src="../../_images/two-sample-hypothesis_16_0.png" />
<img alt="../../_images/two-sample-hypothesis_16_1.png" src="../../_images/two-sample-hypothesis_16_1.png" />
</div>
</div>
<p>Next, we can generate a second SBM with a different number of vertices in each block, but the same probability matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csize_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">75</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">csize_2</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block SBM adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block adjacency spectral embedding&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_18_0.png" src="../../_images/two-sample-hypothesis_18_0.png" />
<img alt="../../_images/two-sample-hypothesis_18_1.png" src="../../_images/two-sample-hypothesis_18_1.png" />
</div>
</div>
<p>Here, we want to test whether the latent positions of the two graphs that we generated are from the same latent distribution. In other words, we are testing</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    H_0 &amp;: F_{X_1} = F_{X_2} Q \\
    H_A &amp;: F_{X_1} \neq F_{X_2} Q
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{X_1}\)</span> is the distribution of <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(F_{X_2}\)</span> is the distribution of <span class="math notranslate nohighlight">\(X_2\)</span>. <span class="math notranslate nohighlight">\(Q\)</span> is the orthogonal rotation matrix, which is necessary since the test can give identical results up to a rotation. We then test using <code class="docutils literal notranslate"><span class="pre">latent_distribution_test</span></code> in <code class="docutils literal notranslate"><span class="pre">graspologic</span></code> on undirected graphs. In this first case, we know that the distributions of the two graphs should be the same, and so we would expect a high p-value.</p>
<p>Before we go into running the test, we have to talk about two independence tests, distance correlation (Dcorr), and multiscale graph correlation (MGC). These are powerful independence tests that operate really well on highly nonlinear and multivariate data. More information about those can be found in the <code class="docutils literal notranslate"><span class="pre">hyppo</span></code> package. Here, we plot the null distribution of the test statistics in blue, the test staitstc in red, and the p-value we get in the title.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldt_dcorr</span> <span class="o">=</span> <span class="n">latent_distribution_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;dcorr&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_1978</span><span class="o">/</span><span class="mf">3803050306.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ldt_dcorr</span> <span class="o">=</span> <span class="n">latent_distribution_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;dcorr&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/graspologic/inference/latent_distribution_test.py</span> in <span class="ni">latent_distribution_test</span><span class="nt">(A1, A2, test, metric, n_components, n_bootstraps, random_state, workers, size_correction, pooled, align_type, align_kws, input_graph)</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span>     <span class="n">test_obj</span> <span class="o">=</span> <span class="n">KSample</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">compute_distkern</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span> 
<span class="ne">--&gt; </span><span class="mi">394</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">test_obj</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">X1_hat</span><span class="p">,</span> <span class="n">X2_hat</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">n_bootstraps</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> 
<span class="g g-Whitespace">    </span><span class="mi">396</span>     <span class="n">null_distribution</span> <span class="o">=</span> <span class="n">test_obj</span><span class="o">.</span><span class="n">indep_test</span><span class="o">.</span><span class="n">null_dist</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/ksample/ksamp.py</span> in <span class="ni">test</span><span class="nt">(self, reps, workers, auto, random_state, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>             <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auto&quot;</span><span class="p">:</span> <span class="n">auto</span><span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span> 
<span class="ne">--&gt; </span><span class="mi">301</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indep_test</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>             <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>         <span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/independence/dcorr.py</span> in <span class="ni">test</span><span class="nt">(self, x, y, reps, workers, auto, perm_blocks, random_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>                 <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">compute_dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_distance</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">is_distance</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">248</span>             <span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Dcorr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>                 <span class="n">x</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>                 <span class="n">y</span><span class="p">,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/independence/base.py</span> in <span class="ni">test</span><span class="nt">(self, x, y, reps, workers, is_distsim, perm_blocks, random_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> 
<span class="g g-Whitespace">    </span><span class="mi">130</span>         <span class="c1"># calculate p-value</span>
<span class="ne">--&gt; </span><span class="mi">131</span>         <span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">null_dist</span> <span class="o">=</span> <span class="n">perm_test</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span>             <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>             <span class="n">x</span><span class="p">,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/tools/common.py</span> in <span class="ni">perm_test</span><span class="nt">(calc_stat, x, y, reps, workers, is_distsim, perm_blocks, random_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> 
<span class="g g-Whitespace">    </span><span class="mi">456</span>     <span class="n">null_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">457</span>         <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">workers</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>             <span class="p">[</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>                 <span class="n">delayed</span><span class="p">(</span><span class="n">_perm_stat</span><span class="p">)(</span><span class="n">calc_stat</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">is_distsim</span><span class="p">,</span> <span class="n">permuter</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span>             <span class="c1"># remaining jobs.</span>
<span class="g g-Whitespace">   </span><span class="mi">1042</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="kc">False</span>
<span class="ne">-&gt; </span><span class="mi">1043</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_one_batch</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1044</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_iterator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1045</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/parallel.py</span> in <span class="ni">dispatch_one_batch</span><span class="nt">(self, iterator)</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>                 <span class="k">return</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">861</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>                 <span class="k">return</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/parallel.py</span> in <span class="ni">_dispatch</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">777</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">778</span>             <span class="n">job_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">779</span>             <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">780</span>             <span class="c1"># A job can complete so quickly than its callback is</span>
<span class="g g-Whitespace">    </span><span class="mi">781</span>             <span class="c1"># called before we get here, causing self._jobs to</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/_parallel_backends.py</span> in <span class="ni">apply_async</span><span class="nt">(self, func, callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>     <span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>         <span class="sd">&quot;&quot;&quot;Schedule a func to be run&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">208</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">ImmediateResult</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>             <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/_parallel_backends.py</span> in <span class="ni">__init__</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>         <span class="c1"># Don&#39;t delay the application, to avoid keeping the input</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="c1"># arguments in memory</span>
<span class="ne">--&gt; </span><span class="mi">572</span>         <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">batch</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span> 
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/joblib/parallel.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/tools/common.py</span> in <span class="ni">_perm_stat</span><span class="nt">(calc_stat, x, y, is_distsim, permuter, random_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>         <span class="n">permy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">order</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span> 
<span class="ne">--&gt; </span><span class="mi">381</span>     <span class="n">perm_stat</span> <span class="o">=</span> <span class="n">calc_stat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">permy</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span> 
<span class="g g-Whitespace">    </span><span class="mi">383</span>     <span class="k">return</span> <span class="n">perm_stat</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/hyppo/independence/dcorr.py</span> in <span class="ni">statistic</span><span class="nt">(self, x, y)</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span>             <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span> 
<span class="ne">--&gt; </span><span class="mi">149</span>         <span class="n">stat</span> <span class="o">=</span> <span class="n">_dcorr</span><span class="p">(</span><span class="n">distx</span><span class="p">,</span> <span class="n">disty</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="n">is_fast</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fast</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>         <span class="bp">self</span><span class="o">.</span><span class="n">stat</span> <span class="o">=</span> <span class="n">stat</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">_compile_for_args</span><span class="nt">(self, *args, **kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span>         <span class="n">return_val</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">434</span>             <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">argtypes</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span>         <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">ForceLiteralArg</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>             <span class="c1"># Received request for compiler re-entry with the list of arguments</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">compile</span><span class="nt">(self, sig)</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span>                 <span class="k">with</span> <span class="n">ev</span><span class="o">.</span><span class="n">trigger_event</span><span class="p">(</span><span class="s2">&quot;numba:compile&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ev_details</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">979</span>                         <span class="n">cres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">980</span>                     <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">ForceLiteralArg</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">981</span>                         <span class="k">def</span> <span class="nf">folded</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kws</span><span class="p">):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">compile</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span> 
<span class="g g-Whitespace">    </span><span class="mi">140</span>     <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">141</span>         <span class="n">status</span><span class="p">,</span> <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_cached</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span>         <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span>             <span class="k">return</span> <span class="n">retval</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">_compile_cached</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> 
<span class="g g-Whitespace">    </span><span class="mi">154</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">155</span>             <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_core</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>         <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">TypingError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_failed_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">_compile_core</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> 
<span class="g g-Whitespace">    </span><span class="mi">167</span>         <span class="n">impl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_implementation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">{})</span>
<span class="ne">--&gt; </span><span class="mi">168</span>         <span class="n">cres</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile_extra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetdescr</span><span class="o">.</span><span class="n">typing_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>                                       <span class="bp">self</span><span class="o">.</span><span class="n">targetdescr</span><span class="o">.</span><span class="n">target_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>                                       <span class="n">impl</span><span class="p">,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">compile_extra</span><span class="nt">(typingctx, targetctx, func, args, return_type, flags, locals, library, pipeline_class)</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span>     <span class="n">pipeline</span> <span class="o">=</span> <span class="n">pipeline_class</span><span class="p">(</span><span class="n">typingctx</span><span class="p">,</span> <span class="n">targetctx</span><span class="p">,</span> <span class="n">library</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">685</span>                               <span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="nb">locals</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">686</span>     <span class="k">return</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">compile_extra</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span> 
<span class="g g-Whitespace">    </span><span class="mi">688</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">compile_extra</span><span class="nt">(self, func)</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span>         <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lifted</span> <span class="o">=</span> <span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span>         <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lifted_from</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">428</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_bytecode</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">429</span> 
<span class="g g-Whitespace">    </span><span class="mi">430</span>     <span class="k">def</span> <span class="nf">compile_ir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_ir</span><span class="p">,</span> <span class="n">lifted</span><span class="o">=</span><span class="p">(),</span> <span class="n">lifted_from</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">_compile_bytecode</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">491</span><span class="sd">         assert self.state.func_ir is None</span>
<span class="ne">--&gt; </span><span class="mi">492</span><span class="sd">         return self._compile_core()</span>
<span class="g g-Whitespace">    </span><span class="mi">493</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">494</span><span class="sd">     def _compile_ir(self):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">_compile_core</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span><span class="sd">                 res = None</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span><span class="sd">                 try:</span>
<span class="ne">--&gt; </span><span class="mi">462</span><span class="sd">                     pm.run(self.state)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span><span class="sd">                     if self.state.cr is not None:</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span><span class="sd">                         break</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">run</span><span class="nt">(self, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span><span class="sd">                 pass_inst = _pass_registry.get(pss).pass_inst</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span><span class="sd">                 if isinstance(pass_inst, CompilerPass):</span>
<span class="ne">--&gt; </span><span class="mi">334</span><span class="sd">                     self._runPass(idx, pass_inst, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span><span class="sd">                 else:</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span><span class="sd">                     raise BaseException(&quot;Legacy pass in use&quot;)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_lock.py</span> in <span class="ni">_acquire_compile_lock</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span><span class="sd">         def _acquire_compile_lock(*args, **kwargs):</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span><span class="sd">             with self:</span>
<span class="ne">---&gt; </span><span class="mi">35</span><span class="sd">                 return func(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span><span class="sd">         return _acquire_compile_lock</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span><span class="sd"> </span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">_runPass</span><span class="nt">(self, index, pss, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span><span class="sd">             mutated |= check(pss.run_initialization, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span><span class="sd">         with SimpleTimer() as pass_time:</span>
<span class="ne">--&gt; </span><span class="mi">289</span><span class="sd">             mutated |= check(pss.run_pass, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span><span class="sd">         with SimpleTimer() as finalize_time:</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span><span class="sd">             mutated |= check(pss.run_finalizer, internal_state)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">check</span><span class="nt">(func, compiler_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">261</span><span class="sd">         def check(func, compiler_state):</span>
<span class="ne">--&gt; </span><span class="mi">262</span><span class="sd">             mangled = func(compiler_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span><span class="sd">             if mangled not in (True, False):</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span><span class="sd">                 msg = (&quot;CompilerPass implementations should return True/False. &quot;</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typed_passes.py</span> in <span class="ni">run_pass</span><span class="nt">(self, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span><span class="sd">                               % (state.func_id.func_name,)):</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span><span class="sd">             # Type inference</span>
<span class="ne">--&gt; </span><span class="mi">105</span><span class="sd">             typemap, return_type, calltypes, errs = type_inference_stage(</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span><span class="sd">                 state.typingctx,</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span><span class="sd">                 state.targetctx,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typed_passes.py</span> in <span class="ni">type_inference_stage</span><span class="nt">(typingctx, targetctx, interp, args, return_type, locals, raise_errors)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span><span class="sd">         infer.build_constraint()</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span><span class="sd">         # return errors in case of partial typing</span>
<span class="ne">---&gt; </span><span class="mi">83</span><span class="sd">         errs = infer.propagate(raise_errors=raise_errors)</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span><span class="sd">         typemap, restype, calltypes = infer.unify(raise_errors=raise_errors)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span><span class="sd"> </span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typeinfer.py</span> in <span class="ni">propagate</span><span class="nt">(self, raise_errors)</span>
<span class="g g-Whitespace">   </span><span class="mi">1064</span><span class="sd">             # Errors can appear when the type set is incomplete; only</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span><span class="sd">             # raise them when there is no progress anymore.</span>
<span class="ne">-&gt; </span><span class="mi">1066</span><span class="sd">             errors = self.constraints.propagate(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1067</span><span class="sd">             newtoken = self.get_state_token()</span>
<span class="g g-Whitespace">   </span><span class="mi">1068</span><span class="sd">             self.debug.propagate_finished()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typeinfer.py</span> in <span class="ni">propagate</span><span class="nt">(self, typeinfer)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span><span class="sd">                                                    lineno=loc.line):</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span><span class="sd">                 try:</span>
<span class="ne">--&gt; </span><span class="mi">154</span><span class="sd">                     constraint(typeinfer)</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span><span class="sd">                 except ForceLiteralArg as e:</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span><span class="sd">                     errors.append(e)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typeinfer.py</span> in <span class="ni">__call__</span><span class="nt">(self, typeinfer)</span>
<span class="g g-Whitespace">    </span><span class="mi">564</span><span class="sd">                 fnty = typevars[self.func].getone()</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span><span class="sd">             with new_error_context(&quot;resolving callee type: {0}&quot;, fnty):</span>
<span class="ne">--&gt; </span><span class="mi">566</span><span class="sd">                 self.resolve(typeinfer, typevars, fnty)</span>
<span class="g g-Whitespace">    </span><span class="mi">567</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">568</span><span class="sd">     def resolve(self, typeinfer, typevars, fnty):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typeinfer.py</span> in <span class="ni">resolve</span><span class="nt">(self, typeinfer, typevars, fnty)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span><span class="sd">             fnty = fnty.instance_type</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span><span class="sd">         try:</span>
<span class="ne">--&gt; </span><span class="mi">589</span><span class="sd">             sig = typeinfer.resolve_call(fnty, pos_args, kw_args)</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span><span class="sd">         except ForceLiteralArg as e:</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span><span class="sd">             # Adjust for bound methods</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typeinfer.py</span> in <span class="ni">resolve_call</span><span class="nt">(self, fnty, pos_args, kw_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1539</span><span class="sd">         else:</span>
<span class="g g-Whitespace">   </span><span class="mi">1540</span><span class="sd">             # Normal non-recursive call</span>
<span class="ne">-&gt; </span><span class="mi">1541</span><span class="sd">             return self.context.resolve_function_type(fnty, pos_args, kw_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1542</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1543</span><span class="sd">     def typeof_global(self, inst, target, gvar):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typing/context.py</span> in <span class="ni">resolve_function_type</span><span class="nt">(self, func, args, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">193</span><span class="sd">         # Prefer user definition first</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span><span class="sd">         try:</span>
<span class="ne">--&gt; </span><span class="mi">195</span><span class="sd">             res = self._resolve_user_function_type(func, args, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span><span class="sd">         except errors.TypingError as e:</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span><span class="sd">             # Capture any typing error</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typing/context.py</span> in <span class="ni">_resolve_user_function_type</span><span class="nt">(self, func, args, kws, literals)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span><span class="sd">         if isinstance(func, types.Callable):</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span><span class="sd">             # XXX fold this into the __call__ attribute logic?</span>
<span class="ne">--&gt; </span><span class="mi">247</span><span class="sd">             return func.get_call_type(self, args, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">249</span><span class="sd">     def _get_attribute_templates(self, typ):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/types/functions.py</span> in <span class="ni">get_call_type</span><span class="nt">(self, context, args, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span>         <span class="n">template</span><span class="p">,</span> <span class="n">pysig</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kws</span> <span class="o">=</span> \
<span class="ne">--&gt; </span><span class="mi">555</span>             <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">get_call_template</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>         <span class="n">sig</span> <span class="o">=</span> <span class="n">template</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>         <span class="k">if</span> <span class="n">sig</span><span class="p">:</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">get_call_template</span><span class="nt">(self, args, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span>         <span class="c1"># Ensure an overload is available</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_compile</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">377</span>             <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span> 
<span class="g g-Whitespace">    </span><span class="mi">379</span>         <span class="c1"># Create function type for typing</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">compile</span><span class="nt">(self, sig)</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span>                 <span class="k">with</span> <span class="n">ev</span><span class="o">.</span><span class="n">trigger_event</span><span class="p">(</span><span class="s2">&quot;numba:compile&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ev_details</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">979</span>                         <span class="n">cres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">980</span>                     <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">ForceLiteralArg</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">981</span>                         <span class="k">def</span> <span class="nf">folded</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kws</span><span class="p">):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">compile</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span> 
<span class="g g-Whitespace">    </span><span class="mi">140</span>     <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">141</span>         <span class="n">status</span><span class="p">,</span> <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_cached</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span>         <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span>             <span class="k">return</span> <span class="n">retval</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">_compile_cached</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> 
<span class="g g-Whitespace">    </span><span class="mi">154</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">155</span>             <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_core</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>         <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">TypingError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_failed_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/dispatcher.py</span> in <span class="ni">_compile_core</span><span class="nt">(self, args, return_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> 
<span class="g g-Whitespace">    </span><span class="mi">167</span>         <span class="n">impl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_implementation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">{})</span>
<span class="ne">--&gt; </span><span class="mi">168</span>         <span class="n">cres</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile_extra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetdescr</span><span class="o">.</span><span class="n">typing_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>                                       <span class="bp">self</span><span class="o">.</span><span class="n">targetdescr</span><span class="o">.</span><span class="n">target_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>                                       <span class="n">impl</span><span class="p">,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">compile_extra</span><span class="nt">(typingctx, targetctx, func, args, return_type, flags, locals, library, pipeline_class)</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span>     <span class="n">pipeline</span> <span class="o">=</span> <span class="n">pipeline_class</span><span class="p">(</span><span class="n">typingctx</span><span class="p">,</span> <span class="n">targetctx</span><span class="p">,</span> <span class="n">library</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">685</span>                               <span class="n">args</span><span class="p">,</span> <span class="n">return_type</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="nb">locals</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">686</span>     <span class="k">return</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">compile_extra</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span> 
<span class="g g-Whitespace">    </span><span class="mi">688</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">compile_extra</span><span class="nt">(self, func)</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span>         <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lifted</span> <span class="o">=</span> <span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span>         <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lifted_from</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">428</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_bytecode</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">429</span> 
<span class="g g-Whitespace">    </span><span class="mi">430</span>     <span class="k">def</span> <span class="nf">compile_ir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_ir</span><span class="p">,</span> <span class="n">lifted</span><span class="o">=</span><span class="p">(),</span> <span class="n">lifted_from</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">_compile_bytecode</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">491</span><span class="sd">         assert self.state.func_ir is None</span>
<span class="ne">--&gt; </span><span class="mi">492</span><span class="sd">         return self._compile_core()</span>
<span class="g g-Whitespace">    </span><span class="mi">493</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">494</span><span class="sd">     def _compile_ir(self):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler.py</span> in <span class="ni">_compile_core</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span><span class="sd">                 res = None</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span><span class="sd">                 try:</span>
<span class="ne">--&gt; </span><span class="mi">462</span><span class="sd">                     pm.run(self.state)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span><span class="sd">                     if self.state.cr is not None:</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span><span class="sd">                         break</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">run</span><span class="nt">(self, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span><span class="sd">                 pass_inst = _pass_registry.get(pss).pass_inst</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span><span class="sd">                 if isinstance(pass_inst, CompilerPass):</span>
<span class="ne">--&gt; </span><span class="mi">334</span><span class="sd">                     self._runPass(idx, pass_inst, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span><span class="sd">                 else:</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span><span class="sd">                     raise BaseException(&quot;Legacy pass in use&quot;)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_lock.py</span> in <span class="ni">_acquire_compile_lock</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span><span class="sd">         def _acquire_compile_lock(*args, **kwargs):</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span><span class="sd">             with self:</span>
<span class="ne">---&gt; </span><span class="mi">35</span><span class="sd">                 return func(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span><span class="sd">         return _acquire_compile_lock</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span><span class="sd"> </span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">_runPass</span><span class="nt">(self, index, pss, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span><span class="sd">             mutated |= check(pss.run_initialization, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span><span class="sd">         with SimpleTimer() as pass_time:</span>
<span class="ne">--&gt; </span><span class="mi">289</span><span class="sd">             mutated |= check(pss.run_pass, internal_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span><span class="sd">         with SimpleTimer() as finalize_time:</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span><span class="sd">             mutated |= check(pss.run_finalizer, internal_state)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/compiler_machinery.py</span> in <span class="ni">check</span><span class="nt">(func, compiler_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">261</span><span class="sd">         def check(func, compiler_state):</span>
<span class="ne">--&gt; </span><span class="mi">262</span><span class="sd">             mangled = func(compiler_state)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span><span class="sd">             if mangled not in (True, False):</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span><span class="sd">                 msg = (&quot;CompilerPass implementations should return True/False. &quot;</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/typed_passes.py</span> in <span class="ni">run_pass</span><span class="nt">(self, state)</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span><span class="sd">                 # Insert native function for use by other jitted-functions.</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span><span class="sd">                 # We also register its library to allow for inlining.</span>
<span class="ne">--&gt; </span><span class="mi">425</span><span class="sd">                 cfunc = targetctx.get_executable(library, fndesc, env)</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span><span class="sd">                 targetctx.insert_user_function(cfunc, fndesc, [library])</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span><span class="sd">                 state[&#39;cr&#39;] = _LowerResult(fndesc, call_helper,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/cpu.py</span> in <span class="ni">get_executable</span><span class="nt">(self, library, fndesc, env)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>         <span class="c1"># Code generation</span>
<span class="ne">--&gt; </span><span class="mi">230</span>         <span class="n">baseptr</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">get_pointer_to_function</span><span class="p">(</span><span class="n">fndesc</span><span class="o">.</span><span class="n">llvm_func_name</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>         <span class="n">fnptr</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">get_pointer_to_function</span><span class="p">(</span><span class="n">fndesc</span><span class="o">.</span><span class="n">llvm_cpython_wrapper_name</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/codegen.py</span> in <span class="ni">get_pointer_to_function</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">    </span><span class="mi">986</span>             <span class="o">-</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="k">if</span> <span class="n">the</span> <span class="n">symbol</span> <span class="ow">is</span> <span class="n">defined</span><span class="o">.</span>
<span class="g g-Whitespace">    </span><span class="mi">987</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">988</span><span class="sd">         self._ensure_finalized()</span>
<span class="g g-Whitespace">    </span><span class="mi">989</span><span class="sd">         ee = self._codegen._engine</span>
<span class="g g-Whitespace">    </span><span class="mi">990</span><span class="sd">         if not ee.is_symbol_defined(name):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/codegen.py</span> in <span class="ni">_ensure_finalized</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">566</span><span class="sd">     def _ensure_finalized(self):</span>
<span class="g g-Whitespace">    </span><span class="mi">567</span><span class="sd">         if not self._finalized:</span>
<span class="ne">--&gt; </span><span class="mi">568</span><span class="sd">             self.finalize()</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">570</span><span class="sd">     def create_ir_module(self, name):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/codegen.py</span> in <span class="ni">finalize</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">761</span><span class="sd">         # Optimize the module after all dependences are linked in above,</span>
<span class="g g-Whitespace">    </span><span class="mi">762</span><span class="sd">         # to allow for inlining.</span>
<span class="ne">--&gt; </span><span class="mi">763</span><span class="sd">         self._optimize_final_module()</span>
<span class="g g-Whitespace">    </span><span class="mi">764</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">765</span><span class="sd">         self._final_module.verify()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/numba/core/codegen.py</span> in <span class="ni">_optimize_final_module</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">681</span><span class="sd">         with self._recorded_timings.record(full_name):</span>
<span class="g g-Whitespace">    </span><span class="mi">682</span><span class="sd">             # The full optimisation suite is then run on the refop pruned IR</span>
<span class="ne">--&gt; </span><span class="mi">683</span><span class="sd">             self._codegen._mpm_full.run(self._final_module)</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">685</span><span class="sd">     def _get_module_for_linking(self):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/llvmlite/binding/passmanagers.py</span> in <span class="ni">run</span><span class="nt">(self, module)</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span><span class="sd">         Run optimization passes on the given module.</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">207</span>         <span class="k">return</span> <span class="n">ffi</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">LLVMPY_RunPassManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span> 
<span class="g g-Whitespace">    </span><span class="mi">209</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/llvmlite/binding/ffi.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">151</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cfn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span> 
<span class="g g-Whitespace">    </span><span class="mi">153</span> 

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldt_mgc</span> <span class="o">=</span> <span class="n">latent_distribution_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;mgc&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7272727272727273 0.8461538461538461
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;null_distribution&#39;</span><span class="p">],</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;DCorr: P-value = </span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;test static&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;null_distribution&#39;</span><span class="p">],</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MGC: P-value = </span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;test static&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_23_0.png" src="../../_images/two-sample-hypothesis_23_0.png" />
</div>
</div>
<p>We see that while the test statistics are samal, the resulting p-value is above 0.05.  So, we fail to reject the null hypothesis that the two graphs come from the same generating distributions.</p>
<p>We can repeat the saem process when generate another SBM with a different interblock probability. We run the test again with the first graph and this new test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>

<span class="n">A3</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">csize_2</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="n">X1</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
<span class="n">X3</span> <span class="o">=</span> <span class="n">AdjacencySpectralEmbed</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block SBM adjacency matrix A1&#39;</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block SBM adjacency matrix A3&#39;</span><span class="p">)</span>
<span class="n">pairplot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block adjacency spectral embedding A1&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2-block adjacency spectral embedding A3&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_25_0.png" src="../../_images/two-sample-hypothesis_25_0.png" />
<img alt="../../_images/two-sample-hypothesis_25_1.png" src="../../_images/two-sample-hypothesis_25_1.png" />
<img alt="../../_images/two-sample-hypothesis_25_2.png" src="../../_images/two-sample-hypothesis_25_2.png" />
<img alt="../../_images/two-sample-hypothesis_25_3.png" src="../../_images/two-sample-hypothesis_25_3.png" />
</div>
</div>
<p>We once again plot the null distribution as before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldt_dcorr</span> <span class="o">=</span> <span class="n">latent_distribution_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;dcorr&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldt_mgc</span> <span class="o">=</span> <span class="n">latent_distribution_test</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;mgc&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002997002997002997 0.000999000999000999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;null_distribution&#39;</span><span class="p">],</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;DCorr: P-value = </span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ldt_dcorr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;test static&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;null_distribution&#39;</span><span class="p">],</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MGC: P-value = </span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ldt_mgc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;test static&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/two-sample-hypothesis_30_0.png" src="../../_images/two-sample-hypothesis_30_0.png" />
</div>
</div>
<p>Thus, we have shown how to do latent position two sample position and distribution testing using methods in graspologic. Now, if you’re ever stuck on a mysterious island with an alien race, and the only way to find you people is do MRI scans and latent positions two sample tests, you know what to do!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./applications/ch9"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ch9.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">9. </span>Applications for Two Networks</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="graph-matching-vertex.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9.2. </span>Graph Matching</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Joshua Vogelstein, Alex Loftus, and Eric Bridgeford<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>