
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Single-Network Models &#8212; Network Machine Learning in Python</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Multi-Network Models" href="multi-network-models.html" />
    <link rel="prev" title="Why Use Statistical Models?" href="why-use-models.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Network Machine Learning in Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Preface
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../foundations/ch1/ch1.html">
   The Network Data Science Landscape
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/what-is-a-network.html">
     What Is A Network?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/why-study-networks.html">
     Why Study Networks?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/examples-of-applications.html">
     Examples of applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/types-of-networks.html">
     Types of Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/types-of-learning-probs.html">
     Types of Network Learning Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch1/exercises.html">
     Exercises
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../foundations/ch2/ch2.html">
   End-to-end Biology Network Data Science Project
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/discover-and-visualize.html">
     Discover and Visualize the Data to Gain Insights
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/prepare-the-data.html">
     Prepare the Data for Network Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/transformation-techniques.html">
     Transformation Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/select-and-train.html">
     Select and Train a Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch2/fine-tune.html">
     Fine-Tune your Model
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../foundations/ch3/ch3.html">
   End-to-end Business Network Data Science Project
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/big-picture.html">
     Look at the Big Picture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/get-the-data.html">
     Get the Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/discover-and-visualize.html">
     Discover and Visualize the Data to Gain Insights
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/ch3/prepare-the-data.html">
     Prepare the Data for Network Algorithms
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Representations
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="ch5.html">
   Why Use Statistical Models?
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="why-use-models.html">
     Why Use Statistical Models?
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Single-Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#references">
     References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multi-network-models.html">
     Multi-Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="models-with-covariates.html">
     Network Models with Covariates
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ch6/ch6.html">
   Learning Graph Representations
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ch6/why-embed-networks.html">
     Why embed networks?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch6/random-walk-diffusion-methods.html">
     Random-Walk and Diffusion-based Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch6/graph-neural-networks.html">
     Graph Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch6/multigraph-representation-learning.html">
     Multigraph Representation Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch6/joint-representation-learning.html">
     Network and Vertex feature joint representation learning
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ch7/ch7.html">
   Theoretical Results
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ch7/theory-single-network.html">
     Theory for Single Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch7/theory-multigraph.html">
     Theory for Multiple-Network Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch7/theory-matching.html">
     Theory for Graph Matching
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../applications/ch8/ch8.html">
   Leveraging Representations for Single Graph Applications
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch8/community-detection.html">
     Community Detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch8/testing-differences.html">
     Testing for Differences between Communities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch8/model-selection.html">
     Model Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch8/vertex-nomination.html">
     Vertex Nomination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch8/anomaly-detection.html">
     Anomaly Detection
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../applications/ch9/ch9.html">
   Leveraging Representations for Multiple Graph Applications
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch9/two-sample-hypothesis.html">
     Two-Sample Hypothesis Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch9/graph-matching-vertex.html">
     Graph Matching and Vertex Nomination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch9/vertex-nomination.html">
     Vertex Nomination
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../applications/ch10/ch10.html">
   Algorithms for more than 2 graphs
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch10/significant-vertices.html">
     Testing for Significant Vertices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/ch10/significant-communities.html">
     Testing for Significant Communities
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://graspologic.readthedocs.io/en/latest/">
   Graspologic Documentation
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/representations/ch5/single-network-models.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        
        <a class="edit-button" href="https://github.com/neurodata/graph-stats-book/edit/master/representations/ch5/single-network-models.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/neurodata/graph-stats-book/master?urlpath=tree/representations/ch5/single-network-models.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Single-Network Models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erdos-renyi-er">
     Erdös-Rényi (ER)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stochastic-block-model-sbm">
     Stochastic Block Model (SBM)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#structured-independent-edge-model-siem">
     Structured Independent Edge Model (SIEM)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-dot-product-graph-rdpg">
     Random Dot Product Graph (RDPG)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalized-random-dot-product-graph-grdpg">
     Generalized Random Dot Product Graph (GRDPG)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degree-corrected-models">
     Degree-Corrected Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inhomogeneous-erdos-renyi-ier">
     Inhomogeneous Erdos-Renyi (IER)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="single-network-models">
<h1>Single-Network Models<a class="headerlink" href="#single-network-models" title="Permalink to this headline">¶</a></h1>
<p>To understand a network as an analytical object, we must clarify the set of behaviors (the <em>statistical properties</em>) we expect that the network might, reasonably, obey. In the case where we have a single network we wish to investigate, we call this set of properties the statistical model for a single network, or the single-network model, for short. The network is assumed to have <span class="math notranslate nohighlight">\(n\)</span> vertices, with <span class="math notranslate nohighlight">\(n^2\)</span> possible edges, and we are interested in conveying information about a hypothetical generative procedure that could produce a network with edges that behaves similarly to our own. These models are generative, in that we describe the properties of the observable data in the network, the edges and vertices, in a statistical way. For instance, consider a social network with <span class="math notranslate nohighlight">\(n\)</span> people, where edges clarify whether a pair of people are connected on the social network. If we know nothing about any of the <span class="math notranslate nohighlight">\(n\)</span> people, a reasonable model might be to simply expect that a pair of people are connected with some arbitrary probability, and that probability is identical for all of the possible pairs of people. On the other hand, if we know that <span class="math notranslate nohighlight">\(n/2\)</span> of the people are in each of <span class="math notranslate nohighlight">\(2\)</span> possible schools, we might anticipate that people within a school will have a higher probability of being connected than people between two schools. This distinction as to how we expect the network to be realized in practice is conveyed by the single-network model that is selected for further analysis.</p>
<p>Before we get started, it is important to clarify that, as scientists, we must pay careful attention to an age old aphorism attributed to George Box, stating: “all models are wrong, but some are useful.” In this sense, it is important to note that the statistical model selected is, in practice, virtually <em>never</em> the correct model. In the context of network statistics, this means that the generative model we select for our network will not be the true generative model that underlies our network. We will almost never have all of the information needed to convey the complex structure of a network; we may lack obvious things such as knowing every possible piece of information that governs whether a pair of vertices is connected or not, or we may not even believe that an edge is a realization of a stochastic process in the first place. Rather, we select a model which is appropriate from a family of candidate models on the basis of two primary factors:</p>
<ol class="simple">
<li><p>The model possesses the level of refinement or complexity needed to answer our scientific question of interest, and</p></li>
<li><p>The model is appropriate for the data we are given.</p></li>
</ol>
<p>The remainder of this section will deal with developing intuition for 1., and a later selection on model selection will cover 2.</p>
<div class="section" id="erdos-renyi-er">
<h2>Erdös-Rényi (ER)<a class="headerlink" href="#erdos-renyi-er" title="Permalink to this headline">¶</a></h2>
<p>The simplest random network model is the Erdös Rényi (ER) model<sup>1</sup>. Consider the social network example explained above. If we do not know anything about how people may, or may not, be connected, the simplest possible thing to do with our network would be to assume that a given pair of people within our network have the same chance of being connected as any other selected pair of people. The <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model formalizes this relatively  situation with a single parameter:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span>: an edge existence probability parameter governing how edges are connected.</p></li>
</ol>
<p>In words, a network with <span class="math notranslate nohighlight">\(n\)</span> vertices which is supposed to be <span class="math notranslate nohighlight">\(ER_n(p)\)</span> has thte property that each pair of vertices is connected with probability <span class="math notranslate nohighlight">\(p\)</span>, not connected with probability <span class="math notranslate nohighlight">\(1-p\)</span>, and that no other properties of the network (including which vertices an edge is incident, other edges within the graph, nor other factors) influence whether a pair of vertices are connected. Statistically, we write that for each edge <span class="math notranslate nohighlight">\(A_{ij}\)</span>, that <span class="math notranslate nohighlight">\(A_{ij}\)</span> is sampled independently and identically from a <span class="math notranslate nohighlight">\(Bernoulli(p)\)</span> distribution, for all <span class="math notranslate nohighlight">\(i, j\)</span> from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(n\)</span>. The word “independent” clarifies that the occurence or not occurence of other edges in the network does not impact the probability of occurence of a given edge, and the word “identical” clarifies that the edge probability <span class="math notranslate nohighlight">\(p\)</span> (or the probability of no edge, <span class="math notranslate nohighlight">\(1-p\)</span>) is the same for all edges within the network.</p>
<p>In practice, the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model may seem too simple to be of practical value, but it holds a fundamental role in network statistical theory. Being simple, it is a straightforward exercise to compute many useful statistical properties of a network which is <span class="math notranslate nohighlight">\(ER_n(p)\)</span>. Consider, for instance, the vertex degree of an undirected graph, <span class="math notranslate nohighlight">\(deg(v_i) = \sum_{j \neq i}A_{ij}\)</span>. Computing the expected vertex degree of a vertex <span class="math notranslate nohighlight">\(v_i\)</span> is a trivial exercise:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \mathbb E[deg(v_i)] &amp;= \mathbb E\left[\sum_{j \neq i} A_{ij}\right] \\
    &amp;= \sum_{j \neq i} \mathbb E[A_{ij}]\;\;\;\;\textrm{Expectation of a finite sum is the sum of the expectations} \\
    &amp;= (n-1) p
\end{align*}\]</div>
<p>Which follows by using the fact that all of the <span class="math notranslate nohighlight">\(n-1\)</span> possible edges which are incident vertex <span class="math notranslate nohighlight">\(v_i\)</span> have the same expected probability of occurence, <span class="math notranslate nohighlight">\(p\)</span>, governed by the parameter for the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model. This tractability of theoretical results makes the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> an ideal candidate graph to study in describing properties of networks to be expected if the network is <span class="math notranslate nohighlight">\(ER_n(p)\)</span>. Similarly, we can easily invert the properties of <span class="math notranslate nohighlight">\(ER_n(p)\)</span> networks, to study when a graph is <em>not</em> an <span class="math notranslate nohighlight">\(ER_n(p)\)</span> random graph, and may merit more careful inferential tasks. On another front, when one wishes to devise new computational techniques and deduce the efficiency or effectiveness of a technique on a network with a given number of nodes and a given number of edges, and is not concerned with how efficient the technique is if the network displays other (potentially exploitable) properties, the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model also makes a good candidate for analysis. This is particularly common when dealing with graphs which are known to be sparse; that is, <span class="math notranslate nohighlight">\(p\)</span> is very small (usually, on the order or less than <span class="math notranslate nohighlight">\(1/n\)</span>).</p>
<p>The following python code can be used to generate and visualize a graph which is generated by the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model. Here, we let <span class="math notranslate nohighlight">\(n=50\)</span> vertices, and the probability of an edge <span class="math notranslate nohighlight">\(p=.3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">heatmap</span>
<span class="kn">from</span> <span class="nn">graspologic.simulations</span> <span class="kn">import</span> <span class="n">er_np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># graph with 50 vertices</span>
<span class="n">ps</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># probability of an edge existing is .3</span>

<span class="c1"># sample a single adj. mtx from ER(50, .3)</span>
<span class="n">As</span> <span class="o">=</span> <span class="n">er_np</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># and plot it</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">As</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ER(50, 0.3) Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;ER(50, 0.3) Simulation&#39;}&gt;
</pre></div>
</div>
<img alt="../../_images/single-network-models_2_1.png" src="../../_images/single-network-models_2_1.png" />
</div>
</div>
<p>In the simple simulation above, we sample a single, undirected, network with loops, with adjacency matrix <span class="math notranslate nohighlight">\(\pmb A^{(s)}\)</span>. We visualize the network using a heatmap, where we recall that a square is dark red if an edge is present, and white if no edge is present.</p>
<p>Given a graph with an adjacency matrix <span class="math notranslate nohighlight">\(\pmb A^{(s)}\)</span>, we can also use graspologic to estimate the probability parameter of the <span class="math notranslate nohighlight">\(ER_n(p)\)</span> model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">EREstimator</span>

<span class="c1"># instantiate an ER Estimator which is directed with loops</span>
<span class="n">er</span> <span class="o">=</span> <span class="n">EREstimator</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># fit an ER model to As</span>
<span class="n">er</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">As</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ER </span><span class="se">\&quot;</span><span class="s2">p</span><span class="se">\&quot;</span><span class="s2"> parameter: </span><span class="si">{</span><span class="n">er</span><span class="o">.</span><span class="n">p_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ER &quot;p&quot; parameter: 0.3144
</pre></div>
</div>
</div>
</div>
<p>As we can see, the probability parameter for a directed network with loops is simply the average edge weight within the network:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average edge weight: </span><span class="si">{</span><span class="n">As</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average edge weight: 0.3144
</pre></div>
</div>
</div>
</div>
<p>Which is in close agreement to the true probability, <span class="math notranslate nohighlight">\(p = 0.3\)</span>. When <span class="math notranslate nohighlight">\(p\)</span> is larger, we might see something like the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># graph has an edge probability of 0.7</span>

<span class="c1"># sample a single adj. mtx from ER(50, 0.7)</span>
<span class="n">Al</span> <span class="o">=</span> <span class="n">er_np</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># and plot it</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">Al</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ER(50, 0.7) Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;ER(50, 0.7) Simulation&#39;}&gt;
</pre></div>
</div>
<img alt="../../_images/single-network-models_8_1.png" src="../../_images/single-network-models_8_1.png" />
</div>
</div>
<p>As the edge existence probability increases, the sampled adjacency matrix tends to have more adjacencies with values of <span class="math notranslate nohighlight">\(1\)</span>. This is because there is a higher chance of an edge existing when <span class="math notranslate nohighlight">\(p\)</span> is larger.</p>
</div>
<div class="section" id="stochastic-block-model-sbm">
<h2>Stochastic Block Model (SBM)<a class="headerlink" href="#stochastic-block-model-sbm" title="Permalink to this headline">¶</a></h2>
<p>The Stochastic Block Model, or SBM, is a random graph model which produces graphs in which edge existence probabilities depend upon which vertices a given edge is adjacent to. If the graph <span class="math notranslate nohighlight">\(G = (\mathcal V, \mathcal E)\)</span> is an SBM with <span class="math notranslate nohighlight">\(n\)</span> vertices, each vertex <span class="math notranslate nohighlight">\(v_i\)</span> can take be a member of one (and only one) of <span class="math notranslate nohighlight">\(K\)</span> possible communities. In this case, rather than having a single edge existence probability, each pair of communities has its own unique edge existence probability. Formally, <span class="math notranslate nohighlight">\(G\)</span> has the parameters:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span>: the number of vertices,</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec \tau \in \{1, ..., K\}^n\)</span>: the vertex assignment vector for each of the <span class="math notranslate nohighlight">\(n\)</span> vertices to one of <span class="math notranslate nohighlight">\(K\)</span> communities, and</p></li>
<li><p><span class="math notranslate nohighlight">\(\pmb B \in [0, 1]^{K \times K}\)</span>: the symmetric edge existence probability for each of the <span class="math notranslate nohighlight">\(K \times K\)</span> possible communities.</p></li>
</ol>
<p>The vertex assignment vector has entries <span class="math notranslate nohighlight">\(\vec \tau_i\)</span>, where <span class="math notranslate nohighlight">\(i = 1, ..., n\)</span>, for each of the vertices in the graph. For a given vertex <span class="math notranslate nohighlight">\(v_i \in \mathcal V\)</span>, the corresponding vertex assignment <span class="math notranslate nohighlight">\(\vec \tau_i\)</span> defines which of the <span class="math notranslate nohighlight">\(K\)</span> communities in which <span class="math notranslate nohighlight">\(v_i\)</span> is a member. For instance, in a social network in which the vertices are students and the edges define whether two students are friends, a vertex assignment vector might denote the school in which each student learns. The matrix <span class="math notranslate nohighlight">\(\pmb B\)</span> with entries <span class="math notranslate nohighlight">\(b_{kl}\)</span> for <span class="math notranslate nohighlight">\(k, l = 1,..., K\)</span> defines the probability of an edge existing between vertices which are in community <span class="math notranslate nohighlight">\(k\)</span> with vertices which are in community <span class="math notranslate nohighlight">\(l\)</span>. For instance, in the social network example, one might select <span class="math notranslate nohighlight">\(\pmb B\)</span> such that the diagonal entries <span class="math notranslate nohighlight">\(b_{kk}\)</span> for <span class="math notranslate nohighlight">\(k = 1,..., K\)</span> tend to exceed off-diagonal entries <span class="math notranslate nohighlight">\(b_{kl}\)</span> where <span class="math notranslate nohighlight">\(k \neq l\)</span> and <span class="math notranslate nohighlight">\(k,l = 1,...,K\)</span>. Further, the matrix <span class="math notranslate nohighlight">\(\pmb B\)</span> is supposed to be symmetric; that is, for any <span class="math notranslate nohighlight">\(b_{kl}\)</span>, it is always the case that <span class="math notranslate nohighlight">\(b_{k,l} = b_{lk}\)</span> for all <span class="math notranslate nohighlight">\(k = 1,..., K\)</span>. Intuitionally, this would correspond to the graph in which each of the  The matrix <span class="math notranslate nohighlight">\(\pmb B\)</span> defines that if vertex <span class="math notranslate nohighlight">\(v_i\)</span> is in community <span class="math notranslate nohighlight">\(k\)</span> and vetex <span class="math notranslate nohighlight">\(v_j\)</span> is in community <span class="math notranslate nohighlight">\(l\)</span>, then an edge <span class="math notranslate nohighlight">\(e_{ij}\)</span> or <span class="math notranslate nohighlight">\(e_{ji}\)</span> exists between <span class="math notranslate nohighlight">\(v_i\)</span> and <span class="math notranslate nohighlight">\(v_j\)</span> with probability <span class="math notranslate nohighlight">\(b_{kl}=b_{lk}\)</span>. Fomally, we wite that <span class="math notranslate nohighlight">\(\pmb A \sim SBM_n(\vec \tau, \pmb B)\)</span> if <span class="math notranslate nohighlight">\(A_{ij} | v_i = k, v_j = l \sim Bernoulli(b_{kl})\)</span>, or equivalently due to the symmetry of <span class="math notranslate nohighlight">\(\pmb B\)</span>, <span class="math notranslate nohighlight">\(A_{ji} | v_i = k, v_j = l \sim Bernoulli(b_{kl})\)</span>, for all <span class="math notranslate nohighlight">\(i,j \in 1,...,n\)</span>.</p>
<p>The following python code can be used to generate and visualize the adjacency matrices describing a graph which has the <span class="math notranslate nohighlight">\(SBM_n(\vec \tau, \pmb B)\)</span> distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.simulations</span> <span class="kn">import</span> <span class="n">sbm</span>

<span class="c1"># for simplicity, the simulation code generates samples wherein</span>
<span class="c1"># vertices from the same community are ordered in the vertex set by</span>
<span class="c1"># their community order. Note that it would be theoretically equivalent to</span>
<span class="c1"># denote the total number of vertices in each community, or provide</span>
<span class="c1"># a vector tau with the first 50 entries taking the value 1, and the</span>
<span class="c1"># second 50 enties taking the value 0, given this fact.</span>
<span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="c1"># total number of vertices is the sum of the </span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">05</span><span class="p">]]</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">heatmap</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;SBM(T, B) Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/single-network-models_11_0.png" src="../../_images/single-network-models_11_0.png" />
</div>
</div>
<p>In the above simulation, we can clearly see an apparent <span class="math notranslate nohighlight">\(4\)</span>-“block structure”, which describes the fact that the probability of an edge existing depends upon which of the <span class="math notranslate nohighlight">\(4\)</span> “blocks” the edge falls into. These blocks are the apparent “subgraphs”, or square patterns, observed in the above graph. The block structure is clearly delineated by the first <span class="math notranslate nohighlight">\(50\)</span> vertices being from a single community, and the second <span class="math notranslate nohighlight">\(50\)</span> vertices being from a different community.</p>
<p>It is important to note that a graph may be <span class="math notranslate nohighlight">\(SBM_n(\vec \tau, \pmb B)\)</span> regardless of whether a block structure is visually discernable. Indeed, the block structure may only be apparent given a particular ordering of the vertices, an otherwise, may not even be discernable at all. Consider, for instance, a similar adjacency matrix to the graph plotted above, with the exact same realization, up to a permutation (reordering) of the vertices. The below graph shows the exact same set of adjacencies as-above, but wherein <span class="math notranslate nohighlight">\(\pmb A\)</span> has had its vertices resorted randomly. The graph has an identical block structuure (up to the reordering of the vertices) as the preceding graph illustrated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># generate a permutation of the n vertices</span>
<span class="n">vtx_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># same adjacency matrix (up to reorder of the vertices)</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">A</span><span class="p">[[</span><span class="n">vtx_perm</span><span class="p">]]</span> <span class="p">[:,</span><span class="n">vtx_perm</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-11-8581568507e8&gt;:8: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  heatmap(A[[vtx_perm]] [:,vtx_perm])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/single-network-models_13_2.png" src="../../_images/single-network-models_13_2.png" />
</div>
</div>
<p>In this sense, it becomes quite difficult in practice to determine whether community structure exists simply by looking at a graph, unless you are looking at a graph in which the vertices are already arranged in an order which respects the community struucture.</p>
</div>
<div class="section" id="structured-independent-edge-model-siem">
<h2>Structured Independent Edge Model (SIEM)<a class="headerlink" href="#structured-independent-edge-model-siem" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="random-dot-product-graph-rdpg">
<h2>Random Dot Product Graph (RDPG)<a class="headerlink" href="#random-dot-product-graph-rdpg" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="generalized-random-dot-product-graph-grdpg">
<h2>Generalized Random Dot Product Graph (GRDPG)<a class="headerlink" href="#generalized-random-dot-product-graph-grdpg" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="degree-corrected-models">
<h2>Degree-Corrected Models<a class="headerlink" href="#degree-corrected-models" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="inhomogeneous-erdos-renyi-ier">
<h2>Inhomogeneous Erdos-Renyi (IER)<a class="headerlink" href="#inhomogeneous-erdos-renyi-ier" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>[1] Erdös P, Rényi A. 1959. “On random graphs, I.” Publ. Math. Debrecen 6:290–297.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./representations/ch5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="why-use-models.html" title="previous page">Why Use Statistical Models?</a>
    <a class='right-next' id="next-link" href="multi-network-models.html" title="next page">Multi-Network Models</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Joshua Vogelstein, Alex Loftus, and Eric Bridgeford<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>